{"version":3,"file":"recorder.js","sources":["utils/recorder.js"],"sourcesContent":["import config from \"../config.js\";\n\nexport default {\n  recorderManager: null,\n  currentFilePath: \"\",\n  timer: null,\n  recordingTime: 0,\n\n  init() {\n    this.recorderManager = uni.getRecorderManager();\n  },\n\n  start() {\n    return new Promise((resolve, reject) => {\n      this.currentFilePath = \"\";\n      this.recordingTime = 0;\n\n      this.recorderManager.start({\n        duration: config.recordOptions.duration,\n        sampleRate: config.recordOptions.sampleRate,\n        numberOfChannels: config.recordOptions.numberOfChannels,\n        encodeBitRate: config.recordOptions.encodeBitRate,\n        format: config.recordOptions.format,\n      });\n\n      // 开始计时\n      this.timer = setInterval(() => {\n        this.recordingTime += 1;\n      }, 1000);\n\n      // 录音开始回调\n      this.recorderManager.onStart(() => {\n        resolve();\n      });\n\n      // 录音错误回调\n      this.recorderManager.onError((err) => {\n        clearInterval(this.timer);\n        reject(err);\n      });\n    });\n  },\n\n  stop() {\n    return new Promise((resolve) => {\n      this.recorderManager.stop();\n\n      // 录音停止回调\n      this.recorderManager.onStop((res) => {\n        clearInterval(this.timer);\n        this.currentFilePath = res.tempFilePath;\n        resolve({\n          filePath: res.tempFilePath,\n          duration: this.recordingTime,\n        });\n      });\n    });\n  },\n\n  getCurrentTime() {\n    return this.recordingTime;\n  },\n\n  getFilePath() {\n    return this.currentFilePath;\n  },\n};\n"],"names":["uni","config"],"mappings":";;;AAEA,MAAe,WAAA;AAAA,EACb,iBAAiB;AAAA,EACjB,iBAAiB;AAAA,EACjB,OAAO;AAAA,EACP,eAAe;AAAA,EAEf,OAAO;AACL,SAAK,kBAAkBA,oBAAI;EAC5B;AAAA,EAED,QAAQ;AACN,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtC,WAAK,kBAAkB;AACvB,WAAK,gBAAgB;AAErB,WAAK,gBAAgB,MAAM;AAAA,QACzB,UAAUC,OAAAA,OAAO,cAAc;AAAA,QAC/B,YAAYA,OAAAA,OAAO,cAAc;AAAA,QACjC,kBAAkBA,OAAAA,OAAO,cAAc;AAAA,QACvC,eAAeA,OAAAA,OAAO,cAAc;AAAA,QACpC,QAAQA,OAAAA,OAAO,cAAc;AAAA,MACrC,CAAO;AAGD,WAAK,QAAQ,YAAY,MAAM;AAC7B,aAAK,iBAAiB;AAAA,MACvB,GAAE,GAAI;AAGP,WAAK,gBAAgB,QAAQ,MAAM;AACjC;MACR,CAAO;AAGD,WAAK,gBAAgB,QAAQ,CAAC,QAAQ;AACpC,sBAAc,KAAK,KAAK;AACxB,eAAO,GAAG;AAAA,MAClB,CAAO;AAAA,IACP,CAAK;AAAA,EACF;AAAA,EAED,OAAO;AACL,WAAO,IAAI,QAAQ,CAAC,YAAY;AAC9B,WAAK,gBAAgB;AAGrB,WAAK,gBAAgB,OAAO,CAAC,QAAQ;AACnC,sBAAc,KAAK,KAAK;AACxB,aAAK,kBAAkB,IAAI;AAC3B,gBAAQ;AAAA,UACN,UAAU,IAAI;AAAA,UACd,UAAU,KAAK;AAAA,QACzB,CAAS;AAAA,MACT,CAAO;AAAA,IACP,CAAK;AAAA,EACF;AAAA,EAED,iBAAiB;AACf,WAAO,KAAK;AAAA,EACb;AAAA,EAED,cAAc;AACZ,WAAO,KAAK;AAAA,EACb;AACH;;"}